(this.webpackJsonpecoffee=this.webpackJsonpecoffee||[]).push([[0],{121:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),r=t(8),o=t.n(r),i=t(11),s=(t(67),t(26),t(39),t(68),t(4)),u=t(69),l=t.n(u),d=t(152),f=t(153),j=function(e){var n=e.onLogin,t=Object(c.useState)(),a=Object(i.a)(t,2),r=a[0],o=a[1];return Object(s.jsxs)("div",{className:l.a.login,children:[Object(s.jsx)(d.a,{onChange:function(e){o(e.target.value)},variant:"standard",label:"Enter your nickname"}),Object(s.jsx)(f.a,{onClick:function(){n&&n(r)},variant:"contained",color:"primary",children:"Enter"})]})},O=t(19),b=t.n(O),p=t(35),v=t(49),m=t(42),h=t.n(m),g=function(e){var n=e.id,t=e.nickname,c=e.onCall;return Object(s.jsxs)("div",{className:h.a.user,children:[Object(s.jsxs)("p",{children:["Nickname - ",n]}),Object(s.jsx)("p",{children:t}),Object(s.jsx)("button",{onClick:function(){return c(n)},children:"Make call"})]})},_=function(e){var n=e.users,t=e.onCall;return Object(s.jsx)("div",{className:h.a.userlist,children:n.map((function(e){return Object(s.jsx)(g,Object(v.a)(Object(v.a)({},e),{},{onCall:t}),e.id)}))})},C=new RTCPeerConnection({iceServers:[{urls:"stun:stun.1.google.com:19302"}]}),x=function(e){e.nickname;var n=e.socket,t=Object(c.useRef)(),a=Object(c.useRef)(),r=Object(c.useState)(),o=Object(i.a)(r,2),u=o[0],l=o[1],d=Object(c.useState)(),f=Object(i.a)(d,2),j=f[0],O=f[1],v=Object(c.useState)([]),m=Object(i.a)(v,2),h=m[0],g=m[1],x=Object(c.useState)(),k=Object(i.a)(x,2),w=k[0],S=k[1];Object(c.useEffect)((function(){var e=[];null===n||void 0===n||n.on("welcome",(function(e){return g(e)})),null===n||void 0===n||n.on("offer",(function(n){var t=n.offer,c=n.callerId;console.log("Recieve offer",t,c),l(t),O(c),C.setRemoteDescription(new RTCSessionDescription(t)).then((function(){console.log("Remote description is set"),e.forEach((function(e){}))}))})),null===n||void 0===n||n.on("answer",(function(e){console.log("Recieve answer",new RTCSessionDescription(e)),C.setRemoteDescription(new RTCSessionDescription(e))})),null===n||void 0===n||n.on("icecandidate",function(){var e=Object(p.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Adding ICE candidate...",new RTCIceCandidate(n)),C.addIceCandidate(new RTCIceCandidate(n));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),C.ontrack=function(e){console.log("Answer got some connection "),a.current.srcObject!==e.streams[0]&&(a.current.srcObject=e.streams[0])}}),[n]);var R=function(){var e=Object(p.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 2:n=e.sent,S(n),t.current.srcObject=n;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(p.a)(b.a.mark((function e(t){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.ontrack=function(){console.log("I got some tracks!")},C.onicecandidate=function(e){e.candidate&&(null===n||void 0===n||n.emit("icecandidate",{id:t,candidate:new RTCIceCandidate(e.candidate)}))},w.getTracks().forEach((function(e){return C.addTrack(e,w)})),e.next=5,C.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:c=e.sent,null===n||void 0===n||n.emit("offer",{id:t,offer:c},(function(){console.log("Offer callback")})),C.setLocalDescription(c);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C.onicecandidate=function(e){e.candidate&&(null===n||void 0===n||n.emit("icecandidate",{id:j,candidate:new RTCIceCandidate(e.candidate)}))},e.next=3,C.createAnswer();case 3:return t=e.sent,null===n||void 0===n||n.emit("answer",{id:j,answer:t}),e.next=7,C.setLocalDescription(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"home",children:[Object(s.jsx)(_,{users:h,onCall:T}),u&&Object(s.jsx)("button",{onClick:E,children:"Answer"}),j&&"Caller: ".concat(j),Object(s.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0}),Object(s.jsx)("video",{ref:a,autoPlay:!0,playsInline:!0}),Object(s.jsx)("button",{onClick:R,children:"OPEN"})]})},k=t(75),w=t.n(k),S=function(){var e=Object(c.useState)(),n=Object(i.a)(e,2),t=n[0],a=n[1],r=Object(c.useState)((function(){return localStorage.getItem("nickname")})),o=Object(i.a)(r,2),u=o[0],l=o[1];return console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/ecoffee",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SIGNALING_SERVER:"https://e-coffee-server.herokuapp.com/"})),Object(c.useEffect)((function(){a(w()("https://e-coffee-server.herokuapp.com/",{withCredentials:!0,extraHeaders:{"ecoffee-nickname":u}}))}),[u]),Object(s.jsxs)("div",{className:"App",children:["https://e-coffee-server.herokuapp.com/",u?Object(s.jsx)(x,{nickname:u,socket:t}):Object(s.jsx)(j,{onLogin:function(e){localStorage.setItem("nickname",e),l(e)}})]})},R=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,155)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),c(e),a(e),r(e),o(e)}))};o.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(S,{})}),document.getElementById("root")),R()},26:function(e,n,t){e.exports={chat:"chat_chat__16YQr",messageInput:"chat_messageInput__wyxMG",message:"chat_message__35AWL",message__sender:"chat_message__sender__31rk4"}},42:function(e,n,t){e.exports={user:"user_user__CVTWO",userlist:"user_userlist__2yMXx"}},69:function(e,n,t){e.exports={login:"login_login__HXn3V"}}},[[121,1,2]]]);
//# sourceMappingURL=main.c581bd97.chunk.js.map