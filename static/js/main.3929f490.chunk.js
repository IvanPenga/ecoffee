(this.webpackJsonpecoffee=this.webpackJsonpecoffee||[]).push([[0],{14:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(6),d=n.n(r),i=n(2),o=n.n(i),s=n(3),u=n(5),f=n(7),l=n.n(f),p=n(1),b=function(e){var t=e.navigation,n=Object(a.useMemo)((function(){return new RTCPeerConnection({})})),c=Object(a.useState)(),r=Object(u.a)(c,2),d=r[0],i=r[1];console.log(navigator,t);var f=Object(a.useState)(null),b=Object(u.a)(f,2),j=b[0],O=b[1],v=Object(a.useRef)(),m=Object(a.useRef)(),g=Object(a.useCallback)(Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 2:t=e.sent,i(t);case 4:case"end":return e.stop()}}),e)}))),[]);Object(a.useEffect)((function(){v.current.srcObject=d}),[d]),Object(a.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then((function(e){})).catch()}),[]);var h=Object(a.useCallback)(Object(s.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.onicecandidate=function(e){if(e.candidate){var t=m.current.value,n=JSON.parse(t);n.candidates.push({address:e.candidate.address,candidate:e.candidate.candidate,component:e.candidate.component,foundation:e.candidate.foundation,port:e.candidate.port,priority:e.candidate.priority,protocol:e.candidate.protocol,relatedAddress:e.candidate.relatedAddress,relatedPort:e.candidate.relatedPort,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid,tcpType:e.candidate.tcpType,type:e.candidate.type,usernameFragment:e.candidate.usernameFragment}),m.current.value=JSON.stringify(n)}},n.ontrack=function(){console.log("Offer got some connection")},d.getTracks().forEach((function(e){return n.addTrack(e,d)})),e.next=5,n.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:t=e.sent,a={offer:t,candidates:[]},m.current.value=JSON.stringify(a),n.setLocalDescription(t);case 9:case"end":return e.stop()}}),e)}))),[d,n]),x=Object(a.useCallback)(Object(s.a)(o.a.mark((function e(){var t,a,c,r,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(m.current.value),a=t.offer,c=t.candidates,n.onicecandidate=function(e){if(e.candidate){var t=m.current.value,n=JSON.parse(t);n.candidates.push({address:e.candidate.address,candidate:e.candidate.candidate,component:e.candidate.component,foundation:e.candidate.foundation,port:e.candidate.port,priority:e.candidate.priority,protocol:e.candidate.protocol,relatedAddress:e.candidate.relatedAddress,relatedPort:e.candidate.relatedPort,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid,tcpType:e.candidate.tcpType,type:e.candidate.type,usernameFragment:e.candidate.usernameFragment}),m.current.value=JSON.stringify(n)}},n.ontrack=function(e){console.log("Answer got some connection "),v.current.srcObject!==e.streams[0]&&(v.current.srcObject=e.streams[0],console.log("pc2 received remote stream",e,e.streams[0]),O("false"))},n.setRemoteDescription(a),c.map((function(e){n.addIceCandidate(e).then().catch((function(e){return console.log(e)}))})),e.next=7,n.createAnswer();case 7:r=e.sent,n.setLocalDescription(r),d={answer:r,candidates:[]},m.current.value=JSON.stringify(d);case 11:case"end":return e.stop()}}),e)}))),[d,n]),y=Object(a.useCallback)((function(){var e=JSON.parse(m.current.value),t=e.answer,a=e.candidates;n.setRemoteDescription(t),a.map((function(e){n.addIceCandidate(e).then().catch((function(e){return console.log(e)}))})),m.current.value="done"}),[d,n]);return Object(p.jsxs)("div",{className:l.a.stream,children:[Object(p.jsx)("video",{suppressContentEditableWarning:j,ref:v,autoPlay:!0,playsInline:!0,onClick:function(e){console.log(e.target)}}),Object(p.jsx)("button",{onClick:g,children:"Start"}),Object(p.jsx)("button",{onClick:h,children:"Offer"}),Object(p.jsx)("button",{onClick:x,children:"Answer"}),Object(p.jsx)("button",{onClick:y,children:"Load"}),Object(p.jsx)("textarea",{ref:m})]})},j=function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(b,{})})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,15)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,d=t.getTTFB;n(e),a(e),c(e),r(e),d(e)}))};d.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(j,{})}),document.getElementById("root")),O()},7:function(e,t,n){}},[[14,1,2]]]);
//# sourceMappingURL=main.3929f490.chunk.js.map